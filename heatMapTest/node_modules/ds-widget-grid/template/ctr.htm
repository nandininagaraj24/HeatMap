<!--{% repeat resources.js %}-->
<script type="text/javascript" src="{{content}}"></script>
<!--{% endrepeat %}-->

<!--{% repeat resources.css %}-->
<link rel="stylesheet" type="text/css" href="{{val}}" />
<!--{% endrepeat %}-->

<div id='{{params.id}}' style="width: 100%; height: 100%">
</div>

<script>

    $(document).ready(function(){
        var params = {{params}};

        var w = params.width || '100%';
        var h = params.height || '100%';

        //
        /*
        var $table = $("#{{params.id}}").width(w).height(h);

        var offW = $table.width(), offH = $table.height() - 60;



        params.width = w;
        params.height = offH;
        */

        var options = {
            paging: true,
            pagingParam:100
        };

        if(params.dataProcess ==  "url")
        {
            options.dataProcess= "url";
            options.url= params.target
        }
        else if(params.dataProcess ==  "pivot"){
          options.dataProcess= "pivot";
          options.data= params.data

          if(params.aggregates)
            options.aggregates=params.aggregates;
          if(params.xDimension)
            options.xDimension= params.xDimension;
          if(params.yDimension)
            options.yDimension= params.yDimension;
        }
        else {
            options.dataProcess= "json";
            options.data= params.data;
        }

        if(params.group)
        {
            options.grouping= true
            options.groupParam= params.group
        }

        if(params.themes)
        {
            options.themes= params.themes;
        }

        if(params.search)
        {
            options.searching= true
        }

        if(params.paging  == false)
        {
            options.paging= false;
        }
        else {
            options.paging= true;
            options.pagingParam =params.pagingParam? params.pagingParam :10;
        }

        if(params.sortable == false)
            options.sortable =false
        if(params.sortParam)
            options.sortParam = params.sortParam;
        if(params.multisort)
            options.multisort = params.multisort;

        if(params.colModel)
            options.colModel = params.colModel;

        if(params.height)
            options.height = params.height;

        if(params.width)
            options.width = params.width;

        if(params.subGrid)
            options.subGrid = params.subGrid;

        if(params.onSelectRow)
           options.onSelectRow = params.onSelectRow;
        if(params.gridComplete)
           options.gridComplete = params.gridComplete;
        if(params.onCellSelect)
          options.onCellSelect = params.onCellSelect;
        if(params.afterInsertRow)
          options.afterInsertRow = params.afterInsertRow;
        if(params.ondblClickRow)
          options.ondblClickRow = params.ondblClickRow;
        if(params.onHeaderClick)
          options.onHeaderClick = params.onHeaderClick;
        if(params.onPaging)
          options.onPaging = params.onPaging;
        if(params.onRightClickRow)
          options.onRightClickRow = params.onRightClickRow;
        if(params.onSelectAll)
          options.onSelectAll = params.onSelectAll;
        if(params.loadComplete)
          options.loadComplete = params.loadComplete;

        if(params.footerrow)
        {
          options.footerrow= true;
          options.userdata= params.userdata;
        }
        if(params.rowTotals)
        {
          options.rowTotals= params.rowTotals;
        }
        else
        {
            options.rowTotals= false;
        }

        if(params.colTotals)
        {
          options.colTotals= params.colTotals;
        }
        else
        {
            options.colTotals= false;
        }

        $('#{{params.id}}').dataBlotter({
            options: options
        });

    });

</script>
